<app-main-header></app-main-header>
<app-navbar></app-navbar>

<!-- Loading State Indicator -->
<div *ngIf="isLoading" class="loading-container">
  <app-spinner [spinnerType]="'s2'" [showOverlay]="false"></app-spinner>
  <div class="loading-progress">
    <div class="progress-bar" [style.width.%]="loadingProgress"></div>
  </div>
  <div class="loading-text">Loading content...</div>
</div>

<!-- Professional Carousel Section -->
<section class="hero-carousel d-none d-md-block" *ngIf="!isLoading">
  <div class="carousel-container">
    <div *ngFor="let item of carousels; let i = index" 
         class="carousel-slide" 
         [class.active]="i === currentSlide">
      <div class="slide-content">
        <div class="overlay"></div>
        <div class="text-content">
          <h2 class="slide-title">{{item.name}}</h2>
          <p class="slide-description">{{item.description}}</p>
          <a href="#" class="btn-cta">Learn More</a>
        </div>
        <div class="image-content">
          <!-- Display image if carousel item has images -->
          <img *ngIf="!item.isVideo && item.carouselImageFiles && item.carouselImageFiles.length > 0" 
               [src]="item.carouselImageFiles[0]?.url" 
               [alt]="item.name">
          
          <!-- Display video if carousel item is a video -->
          <div *ngIf="item.isVideo" class="video-content">
            <!-- For directly uploaded videos -->
            <video *ngIf="item.videoType === 'local' && item.videoUrl" 
                   controls autoplay muted loop>
              <source [src]="item.videoUrl" [type]="item.videoMimeType || 'video/mp4'">
              Your browser does not support the video tag.
            </video>
            
            <!-- For YouTube videos -->
            <iframe *ngIf="item.videoType === 'youtube' && item.videoId"
                    width="100%" height="100%"
                    [src]="sanitizeUrl('https://www.youtube.com/embed/' + item.videoId)"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen>
            </iframe>
            
            <!-- For Vimeo videos -->
            <iframe *ngIf="item.videoType === 'vimeo' && item.videoId"
                    width="100%" height="100%"
                    [src]="sanitizeUrl('https://player.vimeo.com/video/' + item.videoId)"
                    frameborder="0"
                    allow="autoplay; fullscreen; picture-in-picture"
                    allowfullscreen>
            </iframe>
          </div>
        </div>
      </div>
    </div>
  </div>
  <button class="carousel-control prev" (click)="prevSlide()" aria-label="Previous slide">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"></polyline></svg>
  </button>
  <button class="carousel-control next" (click)="nextSlide()" aria-label="Next slide">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"></polyline></svg>
  </button>
  <div class="carousel-indicators">
    <span *ngFor="let item of carousels; let i = index" [class.active]="i === currentSlide" (click)="setCurrentSlide(i)"></span>
  </div>
</section>

<section class="categories" *ngIf="!isLoading">
  <div class="category-header" *ngIf="!isMobile">MAIN CATEGORIES</div>
  <div class="category-container"> <!-- container -> category-container -->
    <button class="scroll-btn left" (click)="scrollCategories('left')">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" 
           stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="15 18 9 12 15 6"></polyline>
      </svg>
    </button>
    
    <div class="category-grid" #categoryGrid>
      <a class="category-card" *ngFor="let category of mainCategories" [routerLink]="['/'+category.id]">
        <div class="category-image">
          <img [src]="category.categoryImage?.url" [alt]="category.name">
        </div>
        <div class="category-content">
          <h3 class="category-title">{{ category.name }}</h3>
          <!-- <p class="category-description" *ngIf="!isMobile" >{{ category.title || 'Ürünlerimizi keşfedin' }}</p> -->
        </div>
      </a>
    </div>
    
    <button class="scroll-btn right" (click)="scrollCategories('right')">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" 
           stroke="currentColor" stroke-width="2" stroke-linecap="round" 
           stroke-linejoin="round">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </button>
  </div>
</section>


<section class="products" *ngIf="!isLoading">
  <app-product-grid 
    *ngIf="mostLikedProducts"
    [products]="mostLikedProducts.items"
    [title]="'Most Liked Products'">
  </app-product-grid>
</section>

<section class="products" *ngIf="!isLoading">
  <app-product-grid 
    *ngIf="mostViewedProducts"
    [products]="mostViewedProducts.items"
    [title]="'Most Viewed Products'">
  </app-product-grid>
</section>

<section class="products" *ngIf="!isLoading">
  <app-product-grid 
    *ngIf="bestSellingProducts"
    [products]="bestSellingProducts.items"
    [title]="'Best Selling Products'">
  </app-product-grid>
</section>

<section class="products" *ngIf="!isLoading">
  <app-product-grid 
    *ngIf="randomProducts"
    [products]="randomProducts.items"
    [title]="'Our Picks For You'">
  </app-product-grid>
</section>

<section class="info-cards">
  <div class="info-container">
    <div class="card-grid">
      <div class="info-card">
        <div class="card-image">
          <img src="../../../../assets/homecard/bestquality3.avif" alt="Kalite">
        </div>
        <div class="card-content">
          <h3 class="card-title">Best Quality</h3>
          <p class="card-description">We find products of the highest quality standards</p>
        </div>
      </div>
      <div class="info-card">
        <div class="card-image">
          <img src="../../../../assets/homecard/inovation.avif" alt="İnovasyon">
        </div>
        <div class="card-content">
          <h3 class="card-title">Inovation</h3>
          <p class="card-description">We work continuously focused on innovation and development.</p>
        </div>
      </div>
      <div class="info-card">
        <div class="card-image">
          <img src="../../../../assets/homecard/forcustomer.avif" alt="Müşteri Hizmetleri">
        </div>
        <div class="card-content">
          <h3 class="card-title">For Customer</h3>
          <p class="card-description">Customer satisfaction is our priority.</p>
        </div>
      </div>
      <div class="info-card">
        <div class="card-image">
          <img src="../../../../assets/homecard/Sustainability.avif" alt="Sürdürülebilirlik">
        </div>
        <div class="card-content">
          <h3 class="card-title">Sustainability</h3>
          <p class="card-description">We offer environmentally friendly production and sustainable solutions.</p>
        </div>
      </div>
    </div>
  </div>
</section>
<app-downbar></app-downbar>
<app-footer></app-footer>


<!-- Modal Trigger -->
<span class="policy-link" (click)="openModal()">{{ translations[currentLang].buttonText }}</span>

<!-- Privacy Policy Modal -->
<app-policy-modal [title]="translations[currentLang].title" [isOpen]="isOpen" (close)="closeModal()">
  <div class="policy-container">
    <!-- Language Selector -->
    <div class="language-selector">
      <button 
        *ngFor="let lang of [Language.EN, Language.TR, Language.RU]"
        (click)="changeLanguage(lang)"
        [class.active]="currentLang === lang"
        class="lang-btn">
        {{ lang.toUpperCase() }}
      </button>
    </div>

    <div class="policy-content">
      <!-- Header Information -->
      <p class="last-updated">
        <strong>{{ translations[currentLang].lastUpdated }}:</strong> {{ lastUpdatedDate | date }}
      </p>

      <!-- Introduction -->
      <section>
        <h3>{{ translations[currentLang].sections.introduction.title }}</h3>
        <p>{{ translations[currentLang].sections.introduction.content }}</p>
      </section>

      <!-- Definitions -->
      <section>
        <h3>{{ translations[currentLang].sections.definitions.title }}</h3>
        <p>{{ translations[currentLang].sections.definitions.content }}</p>
        <div class="definitions-list">
          <dl>
            <ng-container *ngFor="let item of translations[currentLang].sections.definitions.terms">
              <dt>{{ item.term }}</dt>
              <dd>{{ item.definition }}</dd>
            </ng-container>
          </dl>
        </div>
      </section>

      <!-- Data Controller -->
      <section>
        <h3>{{ translations[currentLang].sections.dataController.title }}</h3>
        <p>{{ translations[currentLang].sections.dataController.content }}</p>
        <div class="controller-info">
          <p><strong>{{ dataController.company }}</strong><br>
          {{ dataController.address }}<br>
          {{ translations[currentLang].sections.contactUs.email }} {{ dataController.email }}<br>
          {{ translations[currentLang].sections.contactUs.phone }} {{ dataController.phone }}</p>
        </div>
      </section>

      <!-- Information We Collect -->
      <section>
        <h3>{{ translations[currentLang].sections.collectInfo.title }}</h3>
        <p>{{ translations[currentLang].sections.collectInfo.content }}</p>
        
        <div class="info-category">
          <h4>{{ translations[currentLang].sections.collectInfo.categories.personal.title }}</h4>
          <ul>
            <li *ngFor="let item of translations[currentLang].sections.collectInfo.categories.personal.items">{{ item }}</li>
          </ul>
        </div>
        
        <div class="info-category">
          <h4>{{ translations[currentLang].sections.collectInfo.categories.usage.title }}</h4>
          <ul>
            <li *ngFor="let item of translations[currentLang].sections.collectInfo.categories.usage.items">{{ item }}</li>
          </ul>
        </div>
        
        <div class="info-category">
          <h4>{{ translations[currentLang].sections.collectInfo.categories.marketing.title }}</h4>
          <ul>
            <li *ngFor="let item of translations[currentLang].sections.collectInfo.categories.marketing.items">{{ item }}</li>
          </ul>
        </div>
      </section>

      <!-- Sources -->
      <section>
        <h3>{{ translations[currentLang].sections.sources.title }}</h3>
        <p>{{ translations[currentLang].sections.sources.content }}</p>
        
        <div class="info-category">
          <h4>{{ translations[currentLang].sections.sources.direct.title }}</h4>
          <ul>
            <li *ngFor="let item of translations[currentLang].sections.sources.direct.items">{{ item }}</li>
          </ul>
        </div>
        
        <div class="info-category">
          <h4>{{ translations[currentLang].sections.sources.automated.title }}</h4>
          <ul>
            <li *ngFor="let item of translations[currentLang].sections.sources.automated.items">{{ item }}</li>
          </ul>
        </div>
        
        <div class="info-category">
          <h4>{{ translations[currentLang].sections.sources.thirdParty.title }}</h4>
          <ul>
            <li *ngFor="let item of translations[currentLang].sections.sources.thirdParty.items">{{ item }}</li>
          </ul>
        </div>
      </section>

      <!-- Purposes -->
      <section>
        <h3>{{ translations[currentLang].sections.purposes.title }}</h3>
        <p>{{ translations[currentLang].sections.purposes.content }}</p>
        
        <div class="info-category">
          <h4>{{ translations[currentLang].sections.purposes.essential.title }}</h4>
          <p class="legal-basis">{{ translations[currentLang].sections.purposes.essential.legalBasis }}</p>
          <ul>
            <li *ngFor="let purpose of processingPurposes.essential">{{ purpose }}</li>
          </ul>
        </div>
        
        <div class="info-category">
          <h4>{{ translations[currentLang].sections.purposes.analytical.title }}</h4>
          <p class="legal-basis">{{ translations[currentLang].sections.purposes.analytical.legalBasis }}</p>
          <ul>
            <li *ngFor="let purpose of processingPurposes.analytical">{{ purpose }}</li>
          </ul>
        </div>
        
        <div class="info-category">
          <h4>{{ translations[currentLang].sections.purposes.marketing.title }}</h4>
          <p class="legal-basis">{{ translations[currentLang].sections.purposes.marketing.legalBasis }}</p>
          <ul>
            <li *ngFor="let purpose of processingPurposes.marketing">{{ purpose }}</li>
          </ul>
        </div>
      </section>

      <!-- Legal Basis -->
      <section>
        <h3>{{ translations[currentLang].sections.lawfulBasis.title }}</h3>
        <p>{{ translations[currentLang].sections.lawfulBasis.content }}</p>
        <div class="legal-basis-list">
          <div *ngFor="let basis of translations[currentLang].sections.lawfulBasis.basis" class="legal-basis-item">
            <h4>{{ basis.name }}</h4>
            <p>{{ basis.explanation }}</p>
          </div>
        </div>
      </section>

      <!-- Data Sharing -->
      <section>
        <h3>{{ translations[currentLang].sections.disclosure.title }}</h3>
        <p>{{ translations[currentLang].sections.disclosure.content }}</p>
        <div class="disclosure-categories">
          <div *ngFor="let category of translations[currentLang].sections.disclosure.categories" class="disclosure-category">
            <h4>{{ category.title }}</h4>
            <p>{{ category.description }}</p>
          </div>
        </div>
        <p>{{ translations[currentLang].sections.disclosure.thirdParties }}</p>
      </section>

      <!-- Data Retention -->
      <section>
        <h3>{{ translations[currentLang].sections.retention.title }}</h3>
        <p>{{ translations[currentLang].sections.retention.content }}</p>
        <div class="retention-periods">
          <h4>{{ currentLang === Language.EN ? 'Retention Periods' : 
                 currentLang === Language.TR ? 'Saklama Süreleri' : 
                 'Сроки хранения' }}</h4>
          <ul>
            <li><strong>{{ currentLang === Language.EN ? 'Account Data:' : 
                         currentLang === Language.TR ? 'Hesap Verileri:' : 
                         'Данные учетной записи:' }}</strong> {{ retentionPeriods.accountData }}</li>
            <li><strong>{{ currentLang === Language.EN ? 'Order Data:' : 
                         currentLang === Language.TR ? 'Sipariş Verileri:' : 
                         'Данные заказов:' }}</strong> {{ retentionPeriods.orderData }}</li>
            <li><strong>{{ currentLang === Language.EN ? 'Marketing Data:' : 
                         currentLang === Language.TR ? 'Pazarlama Verileri:' : 
                         'Маркетинговые данные:' }}</strong> {{ retentionPeriods.marketingData }}</li>
            <li><strong>{{ currentLang === Language.EN ? 'Cookie Data:' : 
                         currentLang === Language.TR ? 'Çerez Verileri:' : 
                         'Данные cookie:' }}</strong> {{ retentionPeriods.cookieData }}</li>
            <li><strong>{{ currentLang === Language.EN ? 'Anonymized Data:' : 
                         currentLang === Language.TR ? 'Anonimleştirilmiş Veriler:' : 
                         'Анонимизированные данные:' }}</strong> {{ retentionPeriods.anonymizedData }}</li>
          </ul>
        </div>
      </section>

      <!-- International Transfers -->
      <section>
        <h3>{{ translations[currentLang].sections.international.title }}</h3>
        <p>{{ translations[currentLang].sections.international.content }}</p>
        <ul>
          <li *ngFor="let safeguard of translations[currentLang].sections.international.safeguards">{{ safeguard }}</li>
        </ul>
      </section>

      <!-- Security -->
      <section>
        <h3>{{ translations[currentLang].sections.security.title }}</h3>
        <p>{{ translations[currentLang].sections.security.content }}</p>
        <ul>
          <li *ngFor="let measure of translations[currentLang].sections.security.measures">{{ measure }}</li>
        </ul>
      </section>

      <!-- Your Rights -->
      <section>
        <h3>{{ translations[currentLang].sections.rights.title }}</h3>
        <p>{{ translations[currentLang].sections.rights.content }}</p>
        <div class="rights-list">
          <div *ngFor="let right of translations[currentLang].sections.rights.rightsList" class="right-item">
            <h4>{{ right.name }}</h4>
            <p>{{ right.description }}</p>
          </div>
        </div>
        <p class="exercising-rights">{{ translations[currentLang].sections.rights.exercising }}</p>
      </section>

      <!-- Children's Privacy -->
      <section>
        <h3>{{ translations[currentLang].sections.children.title }}</h3>
        <p>{{ translations[currentLang].sections.children.content }}</p>
      </section>

      <!-- Cookies -->
      <section>
        <h3>{{ translations[currentLang].sections.cookies.title }}</h3>
        <p>{{ translations[currentLang].sections.cookies.content }}</p>
      </section>

      <!-- Changes -->
      <section>
        <h3>{{ translations[currentLang].sections.changes.title }}</h3>
        <p>{{ translations[currentLang].sections.changes.content }}</p>
      </section>

      <!-- Complaints -->
      <section>
        <h3>{{ translations[currentLang].sections.complaints.title }}</h3>
        <p>{{ translations[currentLang].sections.complaints.content }}</p>
        <ul>
          <li>{{ translations[currentLang].sections.complaints.euAuthority }}</li>
          <li>{{ translations[currentLang].sections.complaints.turkishAuthority }}</li>
        </ul>
      </section>

      <!-- Contact Us -->
      <section>
        <h3>{{ translations[currentLang].sections.contactUs.title }}</h3>
        <p>{{ translations[currentLang].sections.contactUs.content }}</p>
        <div class="controller-details">
          <h4>{{ translations[currentLang].sections.contactUs.dataController }}</h4>
          <p><strong>{{ translations[currentLang].sections.contactUs.company }}</strong> {{ dataController.company }}</p>
          <p><strong>{{ translations[currentLang].sections.contactUs.address }}</strong> {{ dataController.address }}</p>
          <p><strong>{{ translations[currentLang].sections.contactUs.representative }}</strong> {{ dataController.representative }}</p>
          <p><strong>{{ translations[currentLang].sections.contactUs.email }}</strong> {{ dataController.email }}</p>
          <p><strong>{{ translations[currentLang].sections.contactUs.phone }}</strong> {{ dataController.phone }}</p>
          <p *ngIf="currentLang === Language.TR"><strong>VERBİS Kayıt No:</strong> {{ dataController.kvkkReg }}</p>
        </div>
      </section>
    </div>
  </div>
</app-policy-modal>